<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Working with Matplotlib in Virtual environments — Matplotlib 1.5.0 documentation</title>
<link href="../_static/mpl.css" rel="stylesheet" type="text/css"/>
<link href="../_static/pygments.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
<script src="../_static/jquery.js" type="text/javascript"></script>
<script src="../_static/underscore.js" type="text/javascript"></script>
<script src="../_static/doctools.js" type="text/javascript"></script>
<link href="../_static/opensearch.xml" rel="search" title="Search within Matplotlib 1.5.0 documentation" type="application/opensearchdescription+xml"/>
<link href="../index.html" rel="top" title="Matplotlib 1.5.0 documentation"/>
<link href="index.html" rel="up" title="The Matplotlib FAQ"/>
<link href="../resources/index.html" rel="next" title="External Resources"/>
<link href="environment_variables_faq.html" rel="prev" title="Environment Variables"/>
<link href="http://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css"/>
<link href="https://matplotlib.org/faq/virtualenv_faq.html" rel="canonical"/></head>
<body><div id="old-version-banner">
            You are reading documentation for a static version of Matplotlib.
            <a href="https://matplotlib.org/faq/virtualenv_faq.html">This page may have been updated.</a>
</div>
<div class="alert" style="background-color: #FEA46C; padding: 10px 0;
">
<h3>We're updating the default styles for Matplotlib 2.0</h3>
<p>Learn what to expect in the <a href="/style_changes.html" style="font-weight: bold;
color: #11557C;">new updates</a></p>
</div>
<link href="/_static/favicon.ico" rel="shortcut icon"/>
<!-- The "Fork me on github" ribbon -->
<img src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" style="float: right; margin-bottom: -40px; top: 0; right: 0; border: 0;" usemap="#ribbonmap"/>
<map name="ribbonmap">
<area coords="15,0,148,-1,148,135" href="https://github.com/matplotlib/matplotlib" shape="poly" title="Fork me on GitHub"/>
</map>
<div style="background-color: white; text-align: left; padding: 10px 10px 15px 15px">
<a href="../index.html"><img alt="matplotlib" border="0" src="../_static/logo2.png"/></a>
</div>
<div class="related">
<h3>Navigation</h3>
<ul>
<li class="right" style="margin-right: 10px">
<a accesskey="I" href="../genindex.html" title="General Index">index</a></li>
<li class="right">
<a href="../py-modindex.html" title="Python Module Index">modules</a> |</li>
<li class="right">
<a accesskey="N" href="../resources/index.html" title="External Resources">next</a> |</li>
<li class="right">
<a accesskey="P" href="environment_variables_faq.html" title="Environment Variables">previous</a> |</li>
<li><a href="../index.html">home</a>| </li>
<li><a href="../examples/index.html">examples</a>| </li>
<li><a href="../gallery.html">gallery</a>| </li>
<li><a href="../api/pyplot_summary.html">pyplot</a>| </li>
<li><a href="../contents.html">docs</a> »</li>
<li><a accesskey="U" href="index.html">The Matplotlib FAQ</a> »</li>
</ul>
</div>
<div class="sphinxsidebar">
<div class="sphinxsidebarwrapper">
<h3><a href="../contents.html">Table Of Contents</a></h3>
<ul>
<li><a class="reference internal" href="#">Working with Matplotlib in Virtual environments</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#gui-frameworks">GUI Frameworks</a></li>
<li><a class="reference internal" href="#osx">OSX</a></li>
</ul>
</li>
</ul>
<h4>Previous topic</h4>
<p class="topless"><a href="environment_variables_faq.html" title="previous chapter">Environment Variables</a></p>
<h4>Next topic</h4>
<p class="topless"><a href="../resources/index.html" title="next chapter">External Resources</a></p>
<div aria-label="source link" role="note">
<h3>This Page</h3>
<ul class="this-page-menu">
<li><a href="../_sources/faq/virtualenv_faq.txt" rel="nofollow">Show Source</a></li>
</ul>
</div>
<div id="searchbox" role="search" style="display: none">
<h3>Quick search</h3>
<form action="../search.html" class="search" method="get">
<input name="q" type="text"/>
<input type="submit" value="Go"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
<p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
</div>
</div>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body">
<div class="section" id="working-with-matplotlib-in-virtual-environments">
<span id="virtualenv-faq"></span><h1>Working with Matplotlib in Virtual environments<a class="headerlink" href="#working-with-matplotlib-in-virtual-environments" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#working-with-matplotlib-in-virtual-environments" id="id2">Working with Matplotlib in Virtual environments</a><ul>
<li><a class="reference internal" href="#introduction" id="id3">Introduction</a></li>
<li><a class="reference internal" href="#gui-frameworks" id="id4">GUI Frameworks</a></li>
<li><a class="reference internal" href="#osx" id="id5">OSX</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<span id="id1"></span><h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>When running <code class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></code> in a
<a class="reference external" href="https://virtualenv.pypa.io/en/latest/">virtual environment</a> you may discover
a few issues. <code class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></code> itself has no issue with virtual environments.
However, the GUI frameworks that <code class="xref py py-mod docutils literal"><span class="pre">matplotlib</span></code> uses for interactive
figures have some issues with virtual environments. Everything below assumes
some familiarity with the Matplotlib backends as found in <a class="reference internal" href="usage_faq.html#what-is-a-backend"><span>What is a
backend?</span></a>.</p>
<p>If you only use the <code class="docutils literal"><span class="pre">IPython/Jupyter</span> <span class="pre">Notebook</span></code>‘s <code class="docutils literal"><span class="pre">inline</span></code> and <code class="docutils literal"><span class="pre">notebook</span></code>
backends and non interactive backends you should not have any issues and can
ignore everything below.</p>
</div>
<div class="section" id="gui-frameworks">
<h2>GUI Frameworks<a class="headerlink" href="#gui-frameworks" title="Permalink to this headline">¶</a></h2>
<p>Interactive Matplotlib relies heavily on the interaction with external GUI
frameworks.</p>
<p>Most GUI frameworks are not pip installable. This makes it tricky to install
them within a virtual environment. This problem does not exist if you use Conda
environments where you can install all Conda supported GUI frameworks directly
into the environment. In regular virtualenv environment various workarounds
exist. Some of these are given here:</p>
<ul class="simple">
<li>The <code class="docutils literal"><span class="pre">TKAgg</span></code> backend doesn’t require any external dependencies and is
normally always available.</li>
<li>The <code class="docutils literal"><span class="pre">QT4</span></code> framework <code class="docutils literal"><span class="pre">PySide</span></code> is pip installable.</li>
<li>The upcoming <a class="reference external" href="http://wiki.wxpython.org/ProjectPhoenix">WX Phoenix</a> toolkit
is <code class="docutils literal"><span class="pre">pip</span></code> installable.</li>
</ul>
<p>Other frameworks are harder to install into a virtual environment. There are at
least two possible ways to get access to these in a virtual environment.</p>
<p>One often suggested solution is to use the <code class="docutils literal"><span class="pre">--system-site-packages</span></code> option
to virtualenv when creating an environment. This adds all system wide packages
to the virtual environment. However, this breaks the isolation between the
virtual environment and the system install. Among other issues it results in
hard to debug problems with system packages shadowing the environment packages.
If you use <a class="reference external" href="https://virtualenvwrapper.readthedocs.org/">virtualenvwrapper</a>
this can be toggled with the <code class="docutils literal"><span class="pre">toggleglobalsitepackages</span></code> command.</p>
<p>Alternatively, you can manually symlink the GUI frameworks into the environment.
I.e. to use PyQt5, you should symlink <code class="docutils literal"><span class="pre">PyQt5</span></code> and <code class="docutils literal"><span class="pre">sip</span></code> from your system
site packages directory into the environment taking care that the environment
and the systemwide install use the same python version.</p>
</div>
<div class="section" id="osx">
<h2>OSX<a class="headerlink" href="#osx" title="Permalink to this headline">¶</a></h2>
<p>On OSX, two different types of Python Builds exist: a regular build and a
framework build. In order to interact correctly with OSX through some
GUI frameworks you need a framework build of Python.
At the time of writing the <code class="docutils literal"><span class="pre">macosx</span></code>, <code class="docutils literal"><span class="pre">WX</span></code> and <code class="docutils literal"><span class="pre">WXAgg</span></code> backends require a
framework build to function correctly. Unfortunately virtualenv creates a non
framework build even if created from a framework build of Python. Conda
environments are framework builds. From
Matplotlib 1.5 onwards the <code class="docutils literal"><span class="pre">macosx</span></code> backend checks that a framework build is
available and fails if a non framework build is found.
WX has a similar check build in.</p>
<p>The issue has been reported on the virtualenv bug tracker <a class="reference external" href="https://github.com/pypa/virtualenv/issues/54">here</a> and <a class="reference external" href="https://github.com/pypa/virtualenv/issues/609">here</a></p>
<p>Until this is fixed, a workaround is needed. The best known workaround,
borrowed  from the <a class="reference external" href="http://wiki.wxpython.org/wxPythonVirtualenvOnMac">WX wiki</a>, is to  use the non
virtualenv python along with the PYTHONHOME environment variable.  This can be
implemented in a script as below. To use this modify <code class="docutils literal"><span class="pre">PYVER</span></code> and
<code class="docutils literal"><span class="pre">PATHTOPYTHON</span></code> and put the script in the virtualenv bin directory i.e.
<code class="docutils literal"><span class="pre">PATHTOVENV/bin/frameworkpython</span></code></p>
<div class="code bash highlight-python"><div class="highlight"><pre>#!/bin/bash

# what real Python executable to use
PYVER=2.7
PATHTOPYTHON=/usr/local/bin/
PYTHON=${PATHTOPYTHON}python${PYVER}

# find the root of the virtualenv, it should be the parent of the dir this script is in
ENV=`$PYTHON -c "import os; print os.path.abspath(os.path.join(os.path.dirname(\"$0\"), '..'))"`

# now run Python with the virtualenv set as Python's HOME
export PYTHONHOME=$ENV
exec $PYTHON "$@"
</pre></div>
</div>
<p>With this in place you can run <code class="docutils literal"><span class="pre">frameworkpython</span></code> to get an interactive
framework build within the virtualenv. To run a script you can do
<code class="docutils literal"><span class="pre">frameworkpython</span> <span class="pre">test.py</span></code> where <code class="docutils literal"><span class="pre">test.py</span></code> is a script that requires a
framework build. To run an interactive <code class="docutils literal"><span class="pre">IPython</span></code> session with the framework
build within the virtual environment you can do <code class="docutils literal"><span class="pre">frameworkpython</span> <span class="pre">-m</span> <span class="pre">IPython</span></code></p>
<p>In addition
<a class="reference external" href="https://github.com/gldnspud/virtualenv-pythonw-osx">virtualenv-pythonw-osx</a>
provides an alternative workaround which may be used to solve the issue.</p>
</div>
</div>
</div>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="footer">
        © Copyright 2002 - 2012 John Hunter, Darren Dale, Eric Firing, Michael Droettboom and the matplotlib development team; 2012 - 2014 The matplotlib development team.
      Last updated on Oct 29, 2015.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-55954603-1', 'auto');
  ga('send', 'pageview');

</script>
</body>
</html>